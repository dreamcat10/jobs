{"remainingRequest":"D:\\H5\\project\\HBuilderProjects\\jobs\\node_modules\\babel-loader\\lib\\index.js!D:\\H5\\project\\HBuilderProjects\\jobs\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\H5\\project\\HBuilderProjects\\jobs\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\H5\\project\\HBuilderProjects\\jobs\\src\\views\\login\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\H5\\project\\HBuilderProjects\\jobs\\src\\views\\login\\Login.vue","mtime":1678355124714},{"path":"D:\\H5\\project\\HBuilderProjects\\jobs\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1673771979702},{"path":"D:\\H5\\project\\HBuilderProjects\\jobs\\node_modules\\babel-loader\\lib\\index.js","mtime":1673772004305},{"path":"D:\\H5\\project\\HBuilderProjects\\jobs\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1673771979702},{"path":"D:\\H5\\project\\HBuilderProjects\\jobs\\node_modules\\vue-loader\\lib\\index.js","mtime":1673772000036}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.map\";\nimport \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { login, getCode } from \"@/network/login.js\";\nimport { chatRooms } from \"@/network/chat.js\";\nimport { createWebSocket } from \"@/api/websocket.js\";\nexport default {\n  name: \"Login\",\n  data: function data() {\n    return {\n      form1: {\n        phone: '',\n        code: '',\n        checked: []\n      },\n      form2: {\n        phone: '',\n        password: '',\n        checked: []\n      },\n      rules: {\n        phone: [{\n          required: true,\n          message: '请输入手机号',\n          trigger: 'change'\n        }, {\n          len: 11,\n          message: '请填写正确的手机号',\n          trigger: 'change'\n        }],\n        code: [{\n          required: true,\n          message: '请输入验证码',\n          trigger: 'change'\n        }],\n        checked: [{\n          required: true,\n          message: '请阅读并勾选上方协议',\n          trigger: 'change'\n        }],\n        password: [{\n          required: true,\n          message: '密码不能为空',\n          trigger: 'change'\n        }]\n      },\n      isLoading: false,\n      isChange: false,\n      isDisable: false,\n      buttonName: '获取验证码',\n      time: 3,\n      timer: null,\n      logMap: []\n    };\n  },\n  methods: {\n    goBack: function goBack() {\n      this.$router.replace(\"/\");\n    },\n    change: function change() {\n      this.isChange = !this.isChange;\n    },\n    sendCode: function sendCode(formName, phone) {\n      var _this = this;\n\n      this.$refs[formName].validateField('phone', function (msg) {\n        if (msg == '') {\n          _this.isDisable = true;\n          getCode(phone).then(function (res) {\n            console.log(res);\n          });\n\n          _this.countDown();\n\n          _this.time = 3;\n        }\n      });\n    },\n    countDown: function countDown() {\n      var _this2 = this;\n\n      if (!this.timer) {\n        this.timer = setInterval(function () {\n          if (_this2.time > 0 && _this2.time <= 60) {\n            _this2.buttonName = _this2.time + '秒后重新获取';\n            _this2.time--;\n          } else {\n            _this2.isDisable = false;\n            _this2.buttonName = '获取验证码';\n            clearInterval(_this2.timer);\n            _this2.timer = null;\n          }\n        }, 1000);\n      }\n    },\n    submitCode: function submitCode(formName) {\n      var num = 0;\n      this.$refs[formName].validateField(['phone', 'checked', 'code'], function (msg) {\n        if (msg == '') {\n          num++;\n        }\n      });\n\n      if (num == 3) {\n        this.isLoading = true;\n        this.getEmp(this.form1);\n      }\n    },\n    submitPass: function submitPass(formName) {\n      var num = 0;\n      this.$refs[formName].validateField(['phone', 'checked', 'password'], function (msg) {\n        if (msg == '') {\n          num++;\n        }\n      });\n\n      if (num == 3) {\n        this.isLoading = true;\n        this.getEmp(this.form2);\n      }\n    },\n    getEmp: function getEmp(form) {\n      var _this3 = this;\n\n      login(form).then(function (res) {\n        _this3.isLoading = false;\n        var data = res.data;\n\n        if (data.code == 200) {\n          var empInfo = data.data;\n          console.log(data);\n\n          _this3.$store.commit('SET_USERINFO', empInfo);\n\n          var id = empInfo.id;\n          createWebSocket(_this3.callback, id);\n\n          _this3.chat(id);\n\n          _this3.$router.replace('/');\n        } else {\n          _this3.$message.error(data.msg);\n        }\n      });\n    },\n    callback: function callback(msg) {\n      this.logMap = this.$store.getters.getLogs;\n      this.logMap.map(function (item) {\n        if (msg.chatRoomId == item.roomId) {\n          item.logs.push(msg);\n        }\n      });\n      this.$store.commit('SET_CHATLOGS', this.logMap);\n    },\n    chat: function chat(id) {\n      var _this4 = this;\n\n      chatRooms(id).then(function (res) {\n        console.log(res);\n        var data = res.data;\n\n        if (data.code == 200) {\n          var rooms = data.data;\n\n          _this4.$store.commit('SET_CHATROOMS', rooms);\n\n          rooms.map(function (item) {\n            var log = {\n              roomId: '',\n              logs: []\n            };\n            log.roomId = item.id, log.logs = [];\n\n            _this4.logMap.push(log);\n          });\n\n          _this4.$store.commit('SET_CHATLOGS', _this4.logMap);\n        } else {\n          console.log(\"获取聊天室信息失败\");\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["Login.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div>\r\n\t\t<div class=\"login\">\r\n\t\t\t<div class=\"login-head\">\r\n\t\t\t\t<div class=\"left\" style=\"margin-top: 25px;\">\r\n\t\t\t\t\t<el-page-header @back=\"goBack\" title=\"返回首页\">\r\n\t\t\t\t\t</el-page-header>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"right\" style=\"width: 83%;\">Jobs招聘</div>\r\n\t\t\t\t</div>\r\n\t\t\t<div class=\"login-main\">\r\n\t\t\t\t<div class=\"login-box\">\r\n\t\t\t\t\t<div class=\"box-head\">\r\n\t\t\t\t\t\t<el-tooltip :class=\"{active: isChange}\" effect=\"light\" content=\"使用密码登录\" placement=\"right-start\">\r\n\t\t\t\t\t\t      <el-button icon=\"el-icon-key\" round @click=change()></el-button>\r\n\t\t\t\t\t\t</el-tooltip>\r\n\t\t\t\t\t\t<el-tooltip style=\"margin: 0;\" :class=\"{active: !isChange}\" effect=\"light\" content=\"使用验证码登录\" placement=\"right-start\">\r\n\t\t\t\t\t\t      <el-button icon=\"el-icon-mobile-phone\" round @click=change()></el-button>\r\n\t\t\t\t\t\t</el-tooltip>\r\n\t\t\t\t\t\t<div class=\"text\">登录</div>\r\n\t\t\t\t\t\t<div class=\"ma-context\" :class=\"{active: isChange}\">\r\n\t\t\t\t\t\t\t<el-form ref=\"form1\" :rules=\"rules\" :model=\"form1\" label-width=\"80px\">\r\n\t\t\t\t\t\t\t\t<el-form-item prop=\"phone\">\r\n\t\t\t\t\t\t\t\t\t<el-input v-model=\"form1.phone\" placeholder=\"手机号\"></el-input>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t<el-form-item prop=\"code\">\r\n\t\t\t\t\t\t\t\t\t<el-input v-model=\"form1.code\"  placeholder=\"短信验证码\">\r\n\t\t\t\t\t\t\t\t\t\t<el-button slot=\"append\" type=\"primary\" \r\n\t\t\t\t\t\t\t\t\t\t:disabled=\"isDisable\" @click=\"sendCode('form1',form1.phone)\">{{buttonName}}</el-button>\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t <el-form-item style=\"text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"submitCode('form1')\" :loading=\"isLoading\">登录</el-button>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t<el-form-item prop=\"checked\">\r\n\t\t\t\t\t\t\t\t\t <el-checkbox v-model=\"form1.checked\">已阅读并同意《用户服务协议》和《隐私政策》</el-checkbox>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t\t\t\t<el-link href='/init' type=\"primary\" :underline=\"false\">没有账号？ 立即注册</el-link>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t</el-form>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"mi-context\" :class=\"{active: !isChange}\">\r\n\t\t\t\t\t\t\t<el-form ref=\"form2\" :rules=\"rules\" :model=\"form2\" label-width=\"80px\">\r\n\t\t\t\t\t\t\t\t<el-form-item prop=\"phone\">\r\n\t\t\t\t\t\t\t\t\t<el-input v-model=\"form2.phone\" placeholder=\"手机号\"></el-input>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t<el-form-item prop=\"password\">\r\n\t\t\t\t\t\t\t\t\t<el-input :show-password=\"true\" v-model=\"form2.password\"  placeholder=\"密码\">\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t</el-input>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t <el-form-item style=\"text-align: center;\">\r\n\t\t\t\t\t\t\t\t\t<el-button type=\"primary\" @click=\"submitPass('form2',form2.phone)\" :loading=isLoading>登录</el-button>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t<el-form-item prop=\"checked\">\r\n\t\t\t\t\t\t\t\t\t <el-checkbox v-model=\"form2.checked\">已阅读并同意《用户服务协议》和《隐私政策》</el-checkbox>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t\t<el-form-item>\r\n\t\t\t\t\t\t\t\t\t<el-link href='/init' type=\"primary\" :underline=\"false\">没有账号？ 立即注册</el-link>\r\n\t\t\t\t\t\t\t\t\t<el-link style=\"margin-left: 40px;\" href='/' type=\"primary\" :underline=\"false\">忘记密码？</el-link>\r\n\t\t\t\t\t\t\t\t</el-form-item>\r\n\t\t\t\t\t\t\t</el-form>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<router-view></router-view>\r\n\t</div>\n</template>\n\n<script>\r\n\timport {login,getCode} from \"@/network/login.js\"\r\n\timport {chatRooms} from \"@/network/chat.js\"\r\n\timport {createWebSocket} from \"@/api/websocket.js\"\r\n\t\n\texport default{\n\t\tname: \"Login\",\r\n\t\tdata(){\r\n\t\t\treturn{\r\n\t\t\t\tform1: {\r\n\t\t\t\t\tphone: '',\r\n\t\t\t\t\tcode: '',\r\n\t\t\t\t\tchecked: [],\r\n\t\t\t\t},\r\n\t\t\t\tform2: {\r\n\t\t\t\t\tphone: '',\r\n\t\t\t\t\tpassword: '',\r\n\t\t\t\t\tchecked: [],\r\n\t\t\t\t},\r\n\t\t\t\trules: {\r\n\t\t\t\t  phone: [\r\n\t\t\t\t\t{ required: true, message: '请输入手机号', trigger: 'change'},\r\n\t\t\t\t\t{ len: 11, message: '请填写正确的手机号' , trigger: 'change'}\r\n\t\t\t\t  ],\r\n\t\t\t\t  code: [\r\n\t\t\t\t\t{ required: true, message: '请输入验证码', trigger: 'change'}\r\n\t\t\t\t  ],\r\n\t\t\t\t  checked: [\r\n\t\t\t\t\t{required: true , message: '请阅读并勾选上方协议',trigger: 'change'}\r\n\t\t\t\t   ],\r\n\t\t\t\t   password: [\r\n\t\t\t\t\t   {required: true , message: '密码不能为空',trigger: 'change'}\r\n\t\t\t\t   ]\r\n\t\t\t\t },\r\n\t\t\t\t isLoading: false,\r\n\t\t\t\t isChange: false,\r\n\t\t\t\t isDisable: false,\r\n\t\t\t\t buttonName: '获取验证码',\r\n\t\t\t\t time: 3,\r\n\t\t\t\t timer: null,\r\n\t\t\t\t logMap: []\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods:{\r\n\t\t\tgoBack(){\r\n\t\t\t\tthis.$router.replace(\"/\")\r\n\t\t\t},\r\n\t\t\tchange(){\r\n\t\t\t\tthis.isChange = !this.isChange;\r\n\t\t\t},\r\n\t\t\tsendCode(formName,phone){\t\t\t\r\n\t\t\t    this.$refs[formName].validateField('phone',(msg) => {\r\n\t\t\t\t\tif(msg == ''){\r\n\t\t\t\t\t\tthis.isDisable = true;\r\n\t\t\t\t\t\tgetCode(phone).then((res) => {\r\n\t\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tthis.countDown();\r\n\t\t\t\t\t\tthis.time = 3\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t})\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t},\t\t\t\r\n\t\t    countDown() {\r\n\t\t\t\tif (!this.timer) {\r\n\t\t\t\tthis.timer = setInterval(() => {\r\n\t\t\t\t  if (this.time > 0 && this.time <= 60) {\r\n\t\t\t\t\tthis.buttonName = this.time + '秒后重新获取';\r\n\t\t\t\t\tthis.time--;\r\n\t\t\t\t  } else {\r\n\t\t\t\t\tthis.isDisable = false;\r\n\t\t\t\t\tthis.buttonName = '获取验证码';\r\n\t\t\t\t\tclearInterval(this.timer);\r\n\t\t\t\t\tthis.timer = null;\r\n\t\t\t\t  }\r\n\t\t\t\t}, 1000);\r\n\t\t\t  }\r\n\t\t    },\r\n\t\t\tsubmitCode(formName) {\r\n\t\t\t\tlet num = 0;\r\n\t\t\t\tthis.$refs[formName].validateField(['phone','checked','code'],(msg) => {\r\n\t\t\t\t\tif(msg == ''){\r\n\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t\tif(num == 3){\r\n\t\t\t\t\tthis.isLoading = true;\r\n\t\t\t\t\tthis.getEmp(this.form1)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsubmitPass(formName) {\r\n\t\t\t\tlet num = 0;\r\n\t\t\t\tthis.$refs[formName].validateField(['phone','checked','password'],(msg) => {\r\n\t\t\t\t\tif(msg == ''){\r\n\t\t\t\t\t\tnum ++;\r\n\t\t\t\t\t}\r\n\t\t\t\t})\t\r\n\t\t\t\tif(num == 3){\r\n\t\t\t\t\tthis.isLoading = true;\r\n\t\t\t\t\tthis.getEmp(this.form2)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetEmp(form){\r\n\t\t\t\tlogin(form).then((res) => {\r\n\t\t\t\t\tthis.isLoading = false;\r\n\t\t\t\t\tlet data = res.data;\r\n\t\t\t\t\tif(data.code == 200){\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tlet empInfo = data.data;\r\n\t\t\t\t\t\tconsole.log(data)\r\n\t\t\t\t\t\tthis.$store.commit('SET_USERINFO',empInfo);\r\n\t\t\t\t\t\tlet id = empInfo.id;\r\n\t\t\t\t\t\tcreateWebSocket(this.callback,id);\r\n\t\t\t\t\t\tthis.chat(id);\r\n\t\t\t\t\t\tthis.$router.replace('/');\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tthis.$message.error(data.msg);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tcallback(msg){\r\n\t\t\t\tthis.logMap = this.$store.getters.getLogs\r\n\t\t\t\tthis.logMap.map(item => {\r\n\t\t\t\t\tif(msg.chatRoomId == item.roomId){\r\n\t\t\t\t\t\titem.logs.push(msg)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tthis.$store.commit('SET_CHATLOGS',this.logMap);\r\n\t\t\t},\r\n\t\t\tchat(id){\r\n\t\t\t\tchatRooms(id).then(res => {\r\n\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\tlet data = res.data\r\n\t\t\t\t\tif(data.code == 200){\r\n\t\t\t\t\t\tlet rooms = data.data\r\n\t\t\t\t\t\tthis.$store.commit('SET_CHATROOMS',rooms);\r\n\t\t\t\t\t\trooms.map(item => {\r\n\t\t\t\t\t\t\tlet log = {\r\n\t\t\t\t\t\t\t\troomId: '',\r\n\t\t\t\t\t\t\t\tlogs: []\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tlog.roomId = item.id,\r\n\t\t\t\t\t\t\tlog.logs = []\r\n\t\t\t\t\t\t\tthis.logMap.push(log)\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tthis.$store.commit('SET_CHATLOGS',this.logMap);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tconsole.log(\"获取聊天室信息失败\")\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t}\n\t}\n</script>\n\n<style scoped>\r\n\t.active{\r\n\t\tdisplay: none;\r\n\t}\r\n\t.login{\r\n\t\theight: 100vh;\r\n\t}\r\n\t.login-head{\r\n\t\tdisplay: flex;\r\n\t\theight: 10%;\r\n\t\twidth: 100%;\r\n\t\tbackground-color: #B3C0D1;\r\n\t\tline-height: 70px;\r\n\t\ttext-align: center;\r\n\t\tcolor: white;\r\n\t\tfont-size: 60px;\r\n\t\tfont-weight: 700;\r\n\t\tfont-family: \"华文行楷\";\r\n\t}\r\n\t.login-main{\r\n\t\theight: 90%;\r\n\t\tposition: relative;\r\n\t}\r\n\t.item{\r\n\t\tmargin: 0;\r\n\t}\r\n\t.login-box{\r\n\t\theight:80%;\r\n\t\twidth:30%;\r\n\t\tborder-radius: 20px;\r\n\t\tbox-shadow: 2px 2px 2px #E5E5E5, -2px -2px 2px #E5E5E5; \r\n\t\tbackground-color:#ffffff;\r\n\t\tposition:absolute;\r\n\t\ttop:15%;\r\n\t\tleft:35%;\r\n\t}\r\n\t.box-head{\r\n\t\twidth: 100%;\r\n\t\t\r\n\t}\r\n\t.text{\r\n\t\tmargin-top: 40px;\r\n\t\ttext-align: center;\r\n\t\tline-height: 60px;\r\n\t\tfont-size: 20px;\r\n\t}\r\n\t.ma-context{\r\n\t\tmargin-top: 50px;\r\n\t\tmargin-left: 20px;\r\n\t\twidth: 70%;\r\n\t}\r\n\t.mi-context{\r\n\t\tmargin-top: 50px;\r\n\t\tmargin-left: 20px;\r\n\t\twidth: 70%;\r\n\t}\r\n\t\n</style>\n"],"sourceRoot":"src/views/login"}]}